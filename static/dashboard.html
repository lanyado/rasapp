<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>מערכת תורנויות</title>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="{{ url_for('static', filename='fonts/fontawesome.css') }}">
  <!-- Bootstrap core CSS -->
  <link href="{{ url_for('static', filename='css/libraries/bootstrap.min.css') }}" rel="stylesheet">
  <!-- Material Design Bootstrap -->
  <link href="{{ url_for('static', filename='css/libraries/mdb/mdb.css') }}" rel="stylesheet">
  <!-- The main table styles -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/libraries/mdb/datatables.css') }}">
  <!-- Calender styles -->
  <link href="{{ url_for('static', filename='css/libraries/calender.css') }}" rel="stylesheet">
  <!-- My styles -->
  <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>

<body dir="rtl">
  <div class="text-center container mb-2">
    <!-- the logo -->
    <img id="logo" src="{{ url_for('static', filename='img/logo.png') }}">
    <div class="wrapper-modal-editor">

      <div class="row d-flex justify-content-center modalWrapper">
        <!--
        =========================================
                    ADD a user
        =========================================
        -->
        <div class="modal fade addNewInputs" id="modalAdd" tabindex="-1" role="dialog" aria-labelledby="modalAdd"
          aria-hidden="true">

          <div class="modal-dialog" style="max-width:700px;" role="document">
            <div class="modal-content">
              <div class="modal-header text-center">

                <h4 class="modal-title w-100 font-weight-bold text-primary ml-5">הוסף חייל חדש</h4>
                <button type="button" class="close text-primary" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>

              <div class="modal-body mx-4">

                <div class="md-form mb-5">
                  <!-- need the js here because "number" input don't support "maxlength" attribute -->
                  <input type="number" maxlength="7" id="inputId1" class="form-control"
                   oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);">
                  <label for="inputId1">מספר אישי</label>
                </div>
                <div class="md-form mb-5">
                  <input type="text" maxlength="40" id="inputName1" class="form-control">
                  <label for="inputName1">שם מלא</label>
                </div>
                <div class="md-form mb-5">
                  <p for="inputUnit1">אגף</p>
                  <select id="inputUnit1" class="form-control match-content">
                      <option value="מודיעין">מודיעין</option>
                      <option value="חימוש">חימוש</option>
                      <option value="מחנה">מחנה</option>
                      <option value="קשר">קשר</option>
                      <option value="אגם">אגם</option>
                      <option value="מקשאפ">מקשאפ </option>
                      <option value="5410">5410</option>
                      <option value="בם">בם</option>
                      <option value="רפואה">רפואה</option>
                      <option value="תקציבים">תקציבים</option>
                      <option value="שלישות">שלישות</option>
                      <option value="לוגיסטיקה">לוגיסטיקה</option>
                      <option value="אביב">ענ אביב</option>
                      <option value="אבן יקרה">אבן יקרה</option>
                  </select>
                </div>
                <div class="md-form mb-5">
                  <h5 class="text-center">הפטורים של החייל</h5>
                  <section class="container">
                      <div class="table table-responsive" id="exemptions-table-warpper1">
                      </div>
                  </section>
                </div>
             </div>
              <div class="modal-footer d-flex justify-content-center buttonAddFormWrapper">
                <button class="btn btn-outline-primary btn-block buttonAdd" data-dismiss="modal">הוסף חייל
                  <i class="far fa-paper-plane ml-1"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="text-center wrapperToBtnModalAdd">
          <a href="" class="btn btn-success btn-rounded btn-sm btnToModalAdd" data-toggle="modal" data-target="#modalAdd" onclick=" $('.exemptions-table-body').html('')">הוסף <i
              class="fas fa-plus-square ml-1"></i></a>
        </div>
        <!--
        =========================================
                    EDIT a user
        =========================================
        -->
        <div class="modal fade modalEditClass" id="modalEdit" tabindex="-1" role="dialog" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header text-center">
                <h4 class="modal-title w-100 font-weight-bold text-secondary ml-5">ערוך חייל</h4>
                <button type="button" class="close text-secondary" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body mx-3 modal-inputs" id="editInputs">
                <div class="md-form mb-5">
                  <input type="number" maxlength="7" id="inputId2" class="form-control">
                  <label for="inputId2">מספר  אישי</label>
                </div>
                <div class="md-form mb-5">
                  <input type="text" id="inputName2" class="form-control">
                  <label for="inputName2">שם מלא</label>
                </div>
                <div class="md-form mb-5">
                  <p for="inputUnit2">אגף</p>
                  <select id="inputUnit2" class="form-control match-content">
                      <option value="מודיעין">מודיעין</option>
                      <option value="חימוש">חימוש</option>
                      <option value="מחנה">מחנה</option>
                      <option value="קשר">קשר</option>
                      <option value="אגם">אגם</option>
                      <option value="מקשאפ">מקשאפ </option>
                      <option value="5410">5410</option>
                      <option value="בם">בם</option>
                      <option value="רפואה">רפואה</option>
                      <option value="תקציבים">תקציבים</option>
                      <option value="שלישות">שלישות</option>
                      <option value="לוגיסטיקה">לוגיסטיקה</option>
                      <option value="אביב">ענ אביב</option>
                      <option value="אבן יקרה">אבן יקרה</option>
                  </select>
                </div>
                <div class="md-form mb-5">
                  <h5 class="text-center">הפטורים של החייל</h5>
                  <section class="container">
                      <div class="table table-responsive" id="exemptions-table-warpper2">
                      </div>
                  </section>
                </div>
              </div>
              <div class="modal-footer d-flex justify-content-center editInsideWrapper">
                <button id="edit" class="btn btn-outline-secondary btn-block editInside" data-dismiss="modal">ערוך חייל 
                  <i class="far fa-paper-plane ml-1"></i>
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="text-center buttonEditWrapper">
          <button class="btn btn-warning btn-rounded btn-sm buttonEdit" onclick="getExemptions()" data-toggle="modal" data-target="#modalEdit"
            disabled>ערוך <i class="fas fa-pen-square ml-1"></i></button>
        </div>
        <!--
        =========================================
                    REMOVE a user
        =========================================
        -->
        <div class="modal fade" id="modalDelete" tabindex="-1" role="dialog" aria-labelledby="modalDelete" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header text-center">
                <h4 class="modal-title w-100 font-weight-bold ml-5 text-danger">הסר חייל</h4>
                <button type="button" class="close text-danger" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body mx-3">
                <p class="text-center h4">האם אתה בטוח שברצונך להסיר את החייל?</p>
              </div>
              <div class="modal-footer d-flex justify-content-center deleteButtonsWrapper">
                <button type="button" class="btn btn-outline-danger btnYesClass" id="btnYes" data-dismiss="modal">כן
                  <i class="far fa-paper-plane ml-1"></i>
                </button>
                <button type="button" class="btn btn-outline-primary btnNoClass" id="btnNo" data-dismiss="modal">לא
                  <i class="far fa-paper-plane ml-1"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
          <button class="btn btn-danger btn-sm btn-rounded buttonDelete" data-toggle="modal" data-target="#modalDelete"
                  disabled>מחק <i class="fas fa-times ml-1"></i></button>
          
          <div class="modal fade modalEditClass" id="modalWatch" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header text-center">
                  <h4 class="modal-title w-100 font-weight-bold text-secondary ml-5">היסטורת התורנויות של החייל</h4>
                </div>  
                  <div class="modal-body mx-3 modal-inputs">
                    <div class="md-form mb-5">
                      <p id="info-last-weekday"></p>
                      <p id="info-last-weekend"></p>
                      <div id="info-weekday-history"></div>
                      <div id="info-weekend-history"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <button class="btn btn-info btn-sm btn-rounded buttonShow" onclick="getUserInfo()" data-toggle="modal" data-target="#modalWatch"
                  disabled>צפה <i class="fas fa-eye ml-1"></i></button>
      </div>
<!--
=========================================
      The TABLE of all the users
=========================================
-->

     <table id="dtBasicExample" class="table table-striped table-bordered" cellspacing="0" width="100%">
        <thead>
         <tr>
            <th class="th-sm">מספר אישי</th>
            <th class="th-sm">שם מלא</th>
            <th class="th-sm">אגף</th>
            <th class="th-sm">פטורים</th>
          </tr>
        </thead>
        <tbody>

    <!-- {{users|safe}} -->
        {% for user in users %}
            <tr>
              <td name="id">{{ user.id }}</td>
              <td>{{ user.name }}</td>
              <td>{{ user.unit }}</td>
              <td> {% for exemption, date in user.exemptions.items() %}{{ exemption }} ({{ date }})<br>{% endfor %}</td>
            </tr>
        {% endfor %}

        </tbody>
      </table>
    </div>
  </div>
<!--
=========================================
              The CALANDER
=========================================
-->
    <div class="container">
          <div class="calendar-section">
            <div class="row">
              <div class="col-sm-6">
                <div class="calendar calendar-first" id="calendar_first">
                  <div class="calendar_header">
                    <button class="switch-month switch-left">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h2></h2>
                    <button class="switch-month switch-right">
                      <i class="fas fa-arrow-right"></i>
                    </button>
                  </div>
                  <div class="calendar_weekdays"></div>
                  <div class="calendar_content"></div>
                </div>
              </div>

              <div class="col-sm-6">
                <div class="calendar calendar-second" id="calendar_second">
                  <div class="calendar_header">
                    <button class="switch-month switch-left">
                      <i class="fas fa-arrow-left"></i>
                    </button>
                    <h2></h2>
                    <button class="switch-month switch-right">
                      <i class="fas fa-arrow-right"></i>
                    </button>
                  </div>
                  <div class="calendar_weekdays"></div>
                  <div class="calendar_content"></div>
                </div>
              </div>
            </div>
          </div>
    </div>

  <div id="to-remove">
    <table class="table table-responsive table-striped table-bordered" id="exemptions-table">
      <thead>
        <tr>
            <td>שם הפטור</td>
            <td>תאריך סיום הפטור</td>
            <td>הסרת הפטור</td>
          </tr>
      </thead>
      <tbody class="exemptions-table-body">
      </tbody>
      <tfoot>
        <tr>
          <th colspan="3">
          <button type="button" class="btn btn-primary btnAdd" data-toggle="tooltip" data-original-title="Add more controls"><i class="glyphicon glyphicon-plus-sign"></i>&nbsp; הוסף פטור&nbsp;</button></th>
        </tr>
      </tfoot>
    </table>
  </div>
  <img id="get-workers" class="final-icon" src="{{ url_for('static', filename='img/excel.png') }}">
  
  <hr>

  <div id="select-warper">
    <h3>בחר גליון לצפייה</h3>

  <div class="select">
    <select id="select-excel">
      {% for file_name in duty_tables %}
          {% if file_name.endswith(' הכי חדש') %}
              <option selected>{{file_name}}</option>
          {% else %}
              <option>{{file_name}}</option>
          {% endif %}
      {% endfor %}
    </select>
  </div>
  <img id="view-excel" class="final-icon" src="{{ url_for('static', filename='img/search.png') }}">
</div>

  <!--
=========================================
              SCRIPTS
=========================================
-->
  <!-- JQuery -->
  <script type="text/javascript" src="{{ url_for('static', filename='js/libraries/jquery-3.3.1.min.js') }}"></script>
  <!-- Bootstrap tooltips -->
  <script type="text/javascript" src="{{ url_for('static', filename='js/libraries/popper.min.js') }}"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="{{ url_for('static', filename='js/libraries/bootstrap.min.js') }}"></script>
  <!-- MDB JavaScript -->
  <script type="text/javascript" src="{{ url_for('static', filename='js/libraries/mdb/mdb.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='js/libraries/mdb/datatables.min.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='js/libraries/mdb/mdb-editor.js') }}"></script>
  <!-- Sweetalert JavaScript -->
  <script type="text/javascript" src="{{ url_for('static', filename='js/libraries/sweetalert.min.js') }}"></script>
  <!-- Calender JavaScript -->
  <script type="text/javascript" src="{{ url_for('static', filename='js/libraries/calender.js') }}"></script>
  <!-- my JavaScript -->
  <script type="text/javascript" src="{{ url_for('static', filename='js/myscript.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='js/exemptions.js') }}"></script>

</body>
</html>
